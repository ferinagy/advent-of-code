package com.github.ferinagy.adventOfCode.aoc2022

fun main() {
    println("Part1:")
    println(part1(testInput1))
    println(part1(input))
}

private fun part1(input: String): String {
    val sum = input.lines().sumOf { snafuToDecimal(it) }

    return decimalToSnafu(sum)
}

private fun snafuToDecimal(snafu: String): Long {
    var result = 0L
    var value = 1L
    val digits = digitsMap.associate { it.second to it.first }
    for (c in snafu.reversed()) {
        val digit = digits[c]!!
        result += digit * value
        value *= 5
    }

    return result
}

private fun decimalToSnafu(number: Long): String {
    var result = ""
    var rest = number
    val digits = digitsMap.toMap()
    while (rest != 0L) {
        var mod = rest % 5
        if (2 < mod) mod -= 5

        result += digits[mod]!!
        rest = (rest - mod) / 5
    }

    return result.reversed()
}

val digitsMap = listOf(-2L to '=', -1L to '-', 0L to '0', 1L to '1', 2L to '2')

private const val testInput1 = """1=-0-2
12111
2=0=
21
2=01
111
20012
112
1=-1=
1-12
12
1=
122"""

private const val input = """10=-=110-0-2-
120121-1=222
122-0=
2-212==00---2021-
1--12202--2201
12010-0=0111-1
12=1=01=2112---111
11==-2===1=022=-10
1-=0
21=02
1-0---1-
102==--2=2==2===2-
2=1-0-=0=022220
11=22
202112100=
1-20=
2=-0=20-220=2=0-11
1=12-001000=
112
2-1==-0---
111122-21100=2
12====-2-0-2
1-12=-0==-
21-2
1-----1=-01
1-1=-0=0-02=020
2-=1
1=012112
1020-220201-1=1=021
2-=11---1=-
1=02
121-1000=-=1=
200-001011000=
2=2-0-2
111-==-0=-01-0
2122-20-2010
1-1-0021
11-
1-22=200-==10
2==-=0
21-20==0==02--=
1-1-11-10=2012==
1==20=--2=02=0-0
10=0=-=0=21-1
22
12021=1212
1-=0=101=1=11=120
2-10--2
10-
1==1=21=02-021
21=1
12=
1-
2=0221=-=22
2=====
101=02110=2-
1=-=
10220=0-10-22-221
20=221==
1-2111-=0
2==02212-1-=---2=
1=20
1==-21=2221=
11=02=0-22--=1--
1=2--=-2
10-00=2=-220202=-
1=2121-=
1-202--1
21-=-0=20=-=-2--1
211-0012--1
1-=
1=--1==-=1122=2200
1=20===1-=112
102=210-0
12
11112-0=0=12
2=-1=--=-20
2-2=-0===-=1=1
2=1=02-00--01-=-0-1
1--=-21
1===--===2
120=2=12-=10=20111
20200--=01=020
1122101=10-212-=0
1=1==-02=00=0-=201-2
1==
10000=
122-2=1122=2
2022==0-2==-
12-22-2-
201==1110-
1=221--=1--0-0
11=22--22200
1-122=0-1-1-=-=-1
2==20==-2-120-010
111=1-0=1121--02
10==0--21101-=11
2=-1=1---
102
1-=0=1==-22-22
2-==2=011-=
1=01-
1=11102112-0==0-=
112222-1=
11-22-0202--0
1=110--=-=-=
2-2--0-0
1==0-==100011-=-
210021-=0001---0
2-=-1-==2=-
1=-01-2=0-01020
1-110=
2110110021-202="""
